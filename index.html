<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Học Câu Gián Tiếp cùng Gemini - Trình độ B1</title>
    <style>
        :root { --primary: #1e40af; --accent: #3b82f6; --bg: #f8fafc; --text: #1e293b; --white: #ffffff; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; max-width: 1000px; margin: auto; padding: 20px; background-color: var(--bg); color: var(--text); }
        
        /* Styles cho phần Card */
        .card { background: var(--white); padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 25px; border: 1px solid #e2e8f0; }
        
        .header-card { text-align: center; border-bottom: 3px solid var(--primary); padding-bottom: 20px; }
        .student-info { display: flex; gap: 15px; justify-content: center; margin-top: 20px; background: #eff6ff; padding: 15px; border-radius: 8px; }
        .student-info input { padding: 10px; border: 1px solid #cbd5e1; border-radius: 5px; width: 220px; }
        
        h1, h2, h3 { color: var(--primary); }
        h2 { border-left: 5px solid var(--primary); padding-left: 15px; margin-top: 30px; background: #f1f5f9; padding-top: 10px; padding-bottom: 10px; }

        /* Styles cho Bảng lý thuyết */
        .theory-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 0.95em; background: var(--white); }
        .theory-table th, .theory-table td { border: 1px solid #e2e8f0; padding: 12px; text-align: left; }
        .theory-table th { background-color: #eff6ff; color: var(--primary); font-weight: bold; }
        .theory-table tr:nth-child(even) { background-color: #f8fafc; }
        
        .grid-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .note { background: #fffbeb; border-left: 4px solid #f59e0b; padding: 15px; margin: 10px 0; font-style: italic; color: #92400e; }

        /* Styles cho Bài tập */
        .question-card { background: var(--white); padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #e2e8f0; transition: 0.3s; }
        .question-card:hover { border-color: var(--accent); }
        .q-text { font-weight: 700; font-size: 1.1em; margin-bottom: 15px; display: block; color: #0f172a; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .option { display: flex; align-items: center; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .option:hover { background: #eff6ff; border-color: var(--accent); }
        .option input { margin-right: 12px; }

        /* Giải thích và Kết quả */
        .explanation { margin-top: 15px; padding: 15px; border-radius: 8px; display: none; font-size: 0.95em; line-height: 1.5; }
        .correct-bg { background: #dcfce7; color: #166534; border: 1px solid #86efac; }
        .wrong-bg { background: #fee2e2; color: #991b1b; border: 1px solid #fca5a5; }
        
        .btn-submit { display: block; width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 30px; transition: 0.3s; }
        .btn-submit:hover { background: #1e3a8a; transform: translateY(-2px); }
        .score-box { text-align: center; font-size: 1.8em; font-weight: bold; margin-top: 30px; color: var(--primary); display: none; padding: 20px; background: #dbeafe; border-radius: 10px; }

        @media (max-width: 768px) { .grid-container, .options-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="card header-card">
    <h1>HƯỚNG DẪN & BÀI TẬP CÂU GIÁN TIẾP</h1>
    <div class="student-info">
        <input type="text" id="name" placeholder="Họ và tên học sinh...">
        <input type="text" id="class" placeholder="Lớp...">
    </div>
</div>

<div class="card">
    <h2>1. Hướng dẫn các biến đổi cơ bản</h2>
    
    <h3>a. Thì của động từ và động từ khuyết thiếu</h3>
    <table class="theory-table">
        <tr><th>Câu trực tiếp</th><th>Câu gián tiếp</th></tr>
        <tr><td>Hiện tại đơn (is/am/are | V0/Vs/es)</td><td>Quá khứ đơn (was/were | V-ed/V2)</td></tr>
        <tr><td>Hiện tại tiếp diễn (am/is/are + V-ing)</td><td>Quá khứ tiếp diễn (was/were + V-ing)</td></tr>
        <tr><td>Hiện tại hoàn thành (have/has + Vp2)</td><td>Quá khứ hoàn thành (had + Vp2)</td></tr>
        <tr><td>Quá khứ đơn (V-ed/V2)</td><td>Quá khứ hoàn thành (had + Vp2)</td></tr>
        <tr><td>Will / Can / May</td><td>Would / Could / Might</td></tr>
        <tr><td>Must / Have to</td><td>Had to</td></tr>
    </table>

    <div class="grid-container">
        <div>
            <h3>b. Đại từ nhân xưng</h3>
            <table class="theory-table">
                <tr><th>Loại</th><th>Trực tiếp</th><th>Gián tiếp</th></tr>
                <tr><td>Chủ ngữ</td><td>I / you / we</td><td>he,she / I,we,they / they</td></tr>
                <tr><td>Tân ngữ</td><td>me / you / us</td><td>him,her / me,us,them / them</td></tr>
                <tr><td>Sở hữu</td><td>my / your / our</td><td>his,her / my,their / their</td></tr>
            </table>
        </div>
        <div>
            <h3>c. Trạng từ chỉ thời gian & nơi chốn</h3>
            <table class="theory-table">
                <tr><th>Trực tiếp</th><th>Gián tiếp</th></tr>
                <tr><td>here / now / today</td><td>there / then / that day</td></tr>
                <tr><td>tomorrow</td><td>the next day / following day</td></tr>
                <tr><td>yesterday</td><td>the day before / previous day</td></tr>
                <tr><td>next / last week</td><td>the following / previous week</td></tr>
            </table>
        </div>
    </div>

    <div class="note">
        <strong>Lưu ý:</strong> Không lùi thì với <b>sự thật hiển nhiên</b> hoặc các từ giữ nguyên: <em>ought to, should, would, could, might.</em>
    </div>
</div>

<div class="card">
    <h2>2. Bài tập thực hành (Trình độ B1)</h2>
    <div id="quiz-container"></div>
    <button class="btn-submit" onclick="checkAnswers()">NỘP BÀI & KIỂM TRA KẾT QUẢ</button>
    <div id="score-display" class="score-box"></div>
</div>

<script>
    const questions = [
        {
            q: "\"I am going to visit my grandparents tomorrow,\" Nam said.",
            options: [
                "Nam said he is going to visit his grandparents tomorrow.",
                "Nam said he was going to visit his grandparents the next day.",
                "Nam said I was going to visit my grandparents the following day.",
                "Nam said he was going to visit my grandparents the next day."
            ],
            correct: 1,
            exp: "Giải thích: Đổi 'I' &rarr; 'he', 'am going' &rarr; 'was going', 'my' &rarr; 'his' và 'tomorrow' &rarr; 'the next day'."
        },
        {
            q: "\"We have lived in this city for ten years,\" they told me.",
            options: [
                "They told me they had lived in that city for ten years.",
                "They told me we had lived in this city for ten years.",
                "They told me they have lived in that city for ten years.",
                "They told me they lived in that city for ten years."
            ],
            correct: 0,
            exp: "Giải thích: Đổi 'We' &rarr; 'they', hiện tại hoàn thành 'have lived' lùi thành 'had lived', và 'this' &rarr; 'that'."
        },
        {
            q: "\"I can't find my keys here,\" Sarah said to her mother.",
            options: [
                "Sarah told her mother she can't find her keys there.",
                "Sarah told her mother I couldn't find my keys here.",
                "Sarah told her mother she couldn't find her keys there.",
                "Sarah told her mother she couldn't find my keys there."
            ],
            correct: 2,
            exp: "Giải thích: Đổi 'I' &rarr; 'she', 'can't' &rarr; 'couldn't', 'my' &rarr; 'her' và 'here' &rarr; 'there'."
        },
        {
            q: "\"The sun rises in the East,\" the teacher explained.",
            options: [
                "The teacher explained that the sun rises in the East.",
                "The teacher explained that the sun rose in the East.",
                "The teacher explained that the sun had risen in the East.",
                "The teacher explained that the sun is rising in the East."
            ],
            correct: 0,
            exp: "Giải thích: Đây là sự thật hiển nhiên (chân lý) nên không thực hiện lùi thì động từ."
        },
        {
            q: "\"I bought a new laptop yesterday,\" Peter said.",
            options: [
                "Peter said he bought a new laptop the day before.",
                "Peter said he had bought a new laptop the previous day.",
                "Peter said he had bought a new laptop yesterday.",
                "Peter said I had bought a new laptop the day before."
            ],
            correct: 1,
            exp: "Giải thích: Quá khứ đơn 'bought' lùi thành quá khứ hoàn thành 'had bought', 'yesterday' &rarr; 'the previous day'."
        },
        {
            q: "\"Are you enjoying your meal?\" the waiter asked us.",
            options: [
                "The waiter asked us if we were enjoying our meal.",
                "The waiter asked us if were we enjoying our meal.",
                "The waiter asked us if you were enjoying your meal.",
                "The waiter asked us that we were enjoying our meal."
            ],
            correct: 0,
            exp: "Giải thích: Câu hỏi Yes/No dùng 'if', đưa câu về dạng trần thuật (S+V) và lùi 'are' &rarr; 'were'."
        },
        {
            q: "\"Does your brother work in this office?\" Mary asked me.",
            options: [
                "Mary asked me if your brother worked in that office.",
                "Mary asked me if my brother works in this office.",
                "Mary asked me if does my brother work in that office.",
                "Mary asked me whether my brother worked in that office."
            ],
            correct: 3,
            exp: "Giải thích: Dùng 'whether', bỏ trợ động từ 'does', lùi động từ chính 'work' &rarr; 'worked', 'this' &rarr; 'that'."
        },
        {
            q: "\"Will you help me with this project next week?\" Jane asked Tom.",
            options: [
                "Jane asked Tom if he would help her with that project the following week.",
                "Jane asked Tom if will he help her with this project next week.",
                "Jane asked Tom if he will help me with that project next week.",
                "Jane asked Tom would he help her with that project the next week."
            ],
            correct: 0,
            exp: "Giải thích: Đổi 'will' &rarr; 'would', 'you' &rarr; 'he', 'me' &rarr; 'her', và 'next week' &rarr; 'the following week'."
        },
        {
            q: "\"Did you see the news on TV last night?\" my father asked.",
            options: [
                "My father asked if I see the news on TV last night.",
                "My father asked if I had seen the news on TV the night before.",
                "My father asked if had I seen the news on TV the previous night.",
                "My father asked if I saw the news on TV the night before."
            ],
            correct: 1,
            exp: "Giải thích: Quá khứ đơn lùi về quá khứ hoàn thành (had seen), 'last night' &rarr; 'the night before'."
        },
        {
            q: "\"Must I finish the report today?\" the employee asked his boss.",
            options: [
                "The employee asked if he must finish the report today.",
                "The employee asked if he had to finish the report that day.",
                "The employee asked if had he to finish the report that day.",
                "The employee asked if he has to finish the report that day."
            ],
            correct: 1,
            exp: "Giải thích: 'Must' lùi thành 'had to', 'I' &rarr; 'he', 'today' &rarr; 'that day'."
        }
    ];

    function renderQuiz() {
        const container = document.getElementById('quiz-container');
        questions.forEach((item, i) => {
            let html = `
                <div class="question-card">
                    <span class="q-text">Câu ${i+1}: ${item.q}</span>
                    <div class="options-grid">
                        ${item.options.map((opt, idx) => `
                            <label class="option">
                                <input type="radio" name="q_${i}" value="${idx}">
                                <span><b>${String.fromCharCode(65 + idx)}.</b> ${opt}</span>
                            </label>
                        `).join('')}
                    </div>
                    <div id="exp_${i}" class="explanation"></div>
                </div>`;
            container.innerHTML += html;
        });
    }

    renderQuiz();

    function checkAnswers() {
        const studentName = document.getElementById('name').value;
        if(!studentName) { alert("Em hãy nhập tên trước khi nộp bài nhé!"); return; }

        let score = 0;
        questions.forEach((item, i) => {
            const selected = document.querySelector(`input[name="q_${i}"]:checked`);
            const expDiv = document.getElementById(`exp_${i}`);
            expDiv.style.display = "block";

            if (selected && parseInt(selected.value) === item.correct) {
                score++;
                expDiv.className = "explanation correct-bg";
                expDiv.innerHTML = "<b>Chính xác! ✓</b><br>" + item.exp;
            } else {
                expDiv.className = "explanation wrong-bg";
                const ansLetter = String.fromCharCode(65 + item.correct);
                expDiv.innerHTML = `<b>Chưa đúng! ✗</b> Đáp án đúng là <b>${ansLetter}</b>.<br>` + item.exp;
            }
        });

        const scoreDisplay = document.getElementById('score-display');
        scoreDisplay.style.display = "block";
        scoreDisplay.innerHTML = `Chúc mừng ${studentName}! Kết quả: ${score}/${questions.length} điểm.`;
        window.scrollTo(0, document.body.scrollHeight);
    }
</script>

</body>
</html>